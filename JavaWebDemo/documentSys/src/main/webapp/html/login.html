<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>无标题文档</title>
</head>

<body>
<h1 align="center">用户登录</h1>
<div align="center" style="color:red">用户名或密码错误</div>
<form id="form1" name="form1" method="post" action="list.html">
  <table width="40%" border="1" align="center" cellpadding="5" cellspacing="0">
    <tr>
      <td>用户名:</td>
      <td>
      <input type="text" name="userName" id="userName" value="" />
      
      </td>
    </tr>
   <tr>
      <td>密码:</td>
      <td>
      <input type="passWord" name="passWord" id="passWord" value=""  /></td>
    </tr>
   
    <tr>
      <td colspan="2" align="center">
      <input type="button" name="sbt" id="sbt" value="登 录" />
      </td>
    </tr>
    
  </table>
</form>
</body>
</html>
<script src="js/jquery.js"></script>
<script>
    /*jq发送请求与后端接口交互*/
    $(function (){
        $("#sbt").click(function (){
            var username=$("#userName").val();
            var password=$("#passWord").val();
            //通过ajax技术发送请求到后端接口
            $.ajax({
                url:"http://localhost:8080/docsys/api/user",
                data:{"type":"login","username":username,"password":password},
                dataType:"json",
                type:"post",
                //回调函数,接收后端响应结果，后端响应的结果放封装data中
                success:function (data){
                    if (data.code=="403"){
                        location.href="login.html"
                    }
                    console.log(data);
                    if (data.success){
                        console.log("登录成功");
                        alert("登录成功");
                        //js有一个本地缓存
                        localStorage.setItem("user",data.data.username)
                        location.href="list.html";
                    }else{
                        console.log("登录失败");
                        $("div").html(data.message);
                    }
                },
                error:function (error){
                    alert("后端出错了！");
            }

            })
        })

    })


</script>